{{/* Renders list of libraries from data/libs.yaml with GitHub language percentages. */}}
{{ $items := site.Data.libs.items }}
{{ if not $items }}<p>No libraries found.</p>{{ end }}
<div class="lib-list">
  {{ range $items }}
  <section class="lib-item">
    <h3 style="display:flex;gap:8px;align-items:center;justify-content:space-between;">
      <span style="display:flex;gap:8px;align-items:center;">
        <a href="{{ .url }}" target="_blank" rel="noopener">{{ .name }}</a>
        {{ partial "libs/github-latest-tag.html" (dict "repo" .repo) }}
        {{ partial "libs/github-last-commit.html" (dict "repo" .repo) }}
      </span>
      {{/* Copy git clone button */}}
      {{ $clone := printf "git clone %s.git" .url }}
      {{ $copiedMsg := cond (eq $.Page.Lang "tr") "Klon kopyalandÄ±" "Clone copied" }}
      <button class="lib-copy" type="button" data-copy="{{ $clone }}" data-msg="{{ $copiedMsg }}" title="Copy: {{ $clone }}" aria-label="Copy git clone">
        <svg class="lib-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
        <span class="lib-copy-toast" aria-live="polite"></span>
      </button>
    </h3>
    <p>{{ index .descriptions $.Page.Lang }}</p>
    {{/* Render language breakdown via embedded helper */}}
    {{ $repo := .repo }}
    {{ partial "libs/github-languages.html" (dict "repo" $repo "page" $.Page) }}
    {{ with .install }}
      {{ $line := index . $.Page.Lang }}
      {{ if $line }}
      <pre><code>{{ $line }}</code></pre>
      {{ end }}
    {{ end }}
  </section>
  {{ end }}
</div>

<script>
if (!window.__libsCopyInit) {
  window.__libsCopyInit = true;
  document.addEventListener('click', function(e){
    var t = e.target.closest && e.target.closest('.lib-copy');
    if (!t) return;
    var txt = t.getAttribute('data-copy');
    if (!txt) return;
    var showMsg = function(){
      var msg = t.getAttribute('data-msg') || 'Copied';
      t.title = msg;
      var toast = t.querySelector && t.querySelector('.lib-copy-toast');
      var icon = t.querySelector && t.querySelector('.lib-icon');
      if (toast) { toast.textContent = msg; toast.classList.add('show'); }
      if (icon) { icon.classList.add('hide'); }
      setTimeout(function(){ if (toast) toast.classList.remove('show'); if (icon) icon.classList.remove('hide'); }, 1500);
    };
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(txt).then(showMsg).catch(function(){
        try { var ta = document.createElement('textarea'); ta.value = txt; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta); showMsg(); } catch(e) {}
      });
    } else {
      try { var ta = document.createElement('textarea'); ta.value = txt; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta); showMsg(); } catch(e) {}
    }
  }, false);
}
</script>

